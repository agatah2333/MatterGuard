{
  "cluster": {
    "id": "0x0091",
    "name": "Electrical Energy Measurement",
    "description": "This cluster provides a mechanism for querying data about the electrical energy imported or provided by the server.",
    "classification": {
      "hierarchy": "Base",
      "role": "Application", 
      "scope": "Endpoint",
      "pics_code": "EEM"
    },
    "revision": {
      "current": 1,
      "history": [
        {
          "revision": 1,
          "description": "Initial Release"
        }
      ]
    },
    "features": [
      {
        "bit": 0,
        "code": "IMPE",
        "name": "ImportedEnergy",
        "conformance": "O.a+",
        "summary": "Measurement of energy imported by the server",
        "description": "The feature indicates the server is capable of measuring how much energy is imported by the server."
      },
      {
        "bit": 1,
        "code": "EXPE",
        "name": "ExportedEnergy", 
        "conformance": "O.a+",
        "summary": "Measurement of energy provided by the server",
        "description": "The feature indicates the server is capable of measuring how much energy is exported by the server."
      },
      {
        "bit": 2,
        "code": "CUME",
        "name": "CumulativeEnergy",
        "conformance": "O.b+",
        "summary": "Measurements are cumulative",
        "description": "The feature indicates the server is capable of measuring how much energy has been imported or exported by the server over the device's lifetime."
      },
      {
        "bit": 3,
        "code": "PERE",
        "name": "PeriodicEnergy",
        "conformance": "O.b+",
        "summary": "Measurements are periodic",
        "description": "The feature indicates the server is capable of measuring how much energy has been imported or exported by the server during a certain period of time."
      }
    ],
    "data_types": [
      {
        "name": "EnergyMeasurementStruct",
        "type": "struct",
        "description": "This struct SHALL indicate the amount of energy measured during a given measurement period.",
        "fields": [
          {
            "id": 0,
            "name": "Energy",
            "type": "energy-mWh",
            "constraint": "0 to 2^62",
            "access": "RV",
            "conformance": "M",
            "description": "This field SHALL be the reported energy."
          },
          {
            "id": 1,
            "name": "StartTimestamp",
            "type": "epoch-s",
            "access": "RV",
            "conformance": "desc",
            "description": "This field SHALL indicate the timestamp in UTC of the beginning of the period during which the value of the Energy field was measured."
          },
          {
            "id": 2,
            "name": "EndTimestamp",
            "type": "epoch-s",
            "constraint": "min (StartTimestamp+1)",
            "access": "RV",
            "conformance": "desc",
            "description": "This field SHALL indicate the timestamp in UTC of the end of the period during which the value of the Energy field was measured."
          },
          {
            "id": 3,
            "name": "StartSystime",
            "type": "systime-ms",
            "access": "RV",
            "conformance": "desc",
            "description": "This field SHALL indicate the seconds since boot at the beginning of the period during which the value of the Energy field was measured."
          },
          {
            "id": 4,
            "name": "EndSystime",
            "type": "systime-ms",
            "constraint": "min (StartSystime+1)",
            "access": "RV",
            "conformance": "desc",
            "description": "This field SHALL indicate the seconds since boot at the end of the period during which the value of the Energy field was measured."
          }
        ]
      },
      {
        "name": "CumulativeEnergyResetStruct",
        "type": "struct", 
        "description": "This struct SHALL represent the times at which cumulative measurements were last zero, either due to initialization of the device, or an internal reset of the cumulative value.",
        "fields": [
          {
            "id": 0,
            "name": "ImportedResetTimestamp",
            "type": "epoch-s",
            "quality": "X",
            "default": "null",
            "access": "RV",
            "conformance": "[IMPE]"
          },
          {
            "id": 1,
            "name": "ExportedResetTimestamp",
            "type": "epoch-s",
            "quality": "X",
            "default": "null",
            "access": "RV",
            "conformance": "[EXPE]"
          },
          {
            "id": 2,
            "name": "ImportedResetSystime",
            "type": "systime-ms",
            "quality": "X",
            "default": "null",
            "access": "RV",
            "conformance": "[IMPE]"
          }
        ]
      }
    ],
    "attributes": [
      {
        "id": "0x0000",
        "name": "Accuracy",
        "type": "MeasurementAccuracyStruct",
        "constraint": null,
        "quality": "F",
        "default": null,
        "access": "RV",
        "conformance": "M",
        "description": "This attribute SHALL indicate the accuracy of energy measurement by this server. The value of the MeasurementType field on this MeasurementAccuracyStruct SHALL be ElectricalEnergy."
      },
      {
        "id": "0x0001", 
        "name": "CumulativeEnergyImported",
        "type": "EnergyMeasurementStruct",
        "constraint": null,
        "quality": "XQ",
        "default": "null",
        "access": "RV",
        "conformance": "IMPE & CUME",
        "description": "This attribute SHALL indicate the most recent measurement of cumulative energy imported by the server over the lifetime of the device, and the timestamp of when the measurement was recorded."
      },
      {
        "id": "0x0002",
        "name": "CumulativeEnergyExported", 
        "type": "EnergyMeasurementStruct",
        "constraint": null,
        "quality": "XQ",
        "default": "null",
        "access": "RV", 
        "conformance": "EXPE & CUME",
        "description": "This attribute SHALL indicate the most recent measurement of cumulative energy exported by the server over the lifetime of the device, and the timestamp of when the measurement was recorded."
      },
      {
        "id": "0x0003",
        "name": "PeriodicEnergyImported",
        "type": "EnergyMeasurementStruct",
        "constraint": null,
        "quality": "XQ",
        "default": "null",
        "access": "RV",
        "conformance": "IMPE & PERE",
        "description": "This attribute SHALL indicate the most recent measurement of energy imported by the server and the period during which it was measured."
      },
      {
        "id": "0x0004",
        "name": "PeriodicEnergyExported",
        "type": "EnergyMeasurementStruct",
        "constraint": null,
        "quality": "XQ",
        "default": "null",
        "access": "RV",
        "conformance": "EXPE & PERE",
        "description": "This attribute SHALL indicate the most recent measurement of energy exported by the server and the period during which it was measured."
      },
      {
        "id": "0x0005",
        "name": "CumulativeEnergyReset",
        "type": "CumulativeEnergyResetStruct",
        "constraint": null,
        "quality": "X",
        "default": "null",
        "access": "RV",
        "conformance": "[CUME]",
        "description": "This attribute SHALL represent the times at which cumulative measurements were last zero."
      }
    ],
    "commands": [],
    "events": [
      {
        "id": 0,
        "name": "CumulativeEnergyMeasured",
        "priority": "INFO",
        "access": "RV",
        "conformance": "CUME",
        "description": "This event SHALL be generated when the server takes a snapshot of the cumulative energy imported by the server, exported from the server, or both.",
        "fields": [
          {
            "id": 0,
            "name": "EnergyImported",
            "type": "EnergyMeasurementStruct",
            "conformance": "CUME & IMPE",
            "description": "This field SHALL be the value of CumulativeEnergyImported attribute at the timestamp indicated in its EndTimestamp field, EndSystime field, or both."
          },
          {
            "id": 1,
            "name": "EnergyExported",
            "type": "EnergyMeasurementStruct",
            "conformance": "CUME & EXPE",
            "description": "This field SHALL be the value of CumulativeEnergyExported attribute at the timestamp indicated in its EndTimestamp field, EndSystime field, or both."
          }
        ]
      },
      {
        "id": 1,
        "name": "PeriodicEnergyMeasured",
        "priority": "INFO",
        "access": "RV",
        "conformance": "PERE",
        "description": "This event SHALL be generated when the server reaches the end of a reporting period for imported energy, exported energy, or both.",
        "fields": [
          {
            "id": 0,
            "name": "EnergyImported",
            "type": "EnergyMeasurementStruct",
            "conformance": "PERE & IMPE",
            "description": "This field SHALL be the value of PeriodicEnergyImported attribute at the timestamp indicated in its EndTimestamp field, EndSystime field, or both."
          },
          {
            "id": 1,
            "name": "EnergyExported",
            "type": "EnergyMeasurementStruct",
            "conformance": "PERE & EXPE",
            "description": "This field SHALL be the value of PeriodicEnergyExported attribute at the timestamp indicated in its EndTimestamp field, EndSystime field, or both."
          }
        ]
      }
    ]
  }
}